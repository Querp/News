{% extends 'main/base.html' %}
{% load static %}
{% load human_date %}


{% block title %}
  My Articles
{% endblock %}

{% block content %}

<form method="post" action="{% url 'fetch_sources' %}">
  {% csrf_token %}
  <button type="submit">
    Fetch news sources
  </button>
</form>

<form method="post" action="{% url 'fetch_sources_images' %}"
      onsubmit="return confirm('Fetch images for sources without logos?');">
  {% csrf_token %}
  <input type="hidden" name="admin_token" value="{{ ADMIN_SYNC_TOKEN }}">
  <button type="submit">
    Fetch source images
  </button>
</form>


<div class="articles">
  <article class="saved-count">
    <p>{{ articles|length }} </p>
    <p>Saved Articles</p>
  </article>
  {% for article in articles %}
    <article>
        <a href="{{ article.url }}" target="_blank">
          <div class="header">
            {% if article.url_to_image %}
                <img src="{{ article.url_to_image }}" alt="" />
            {% else %}
                <img src={% static "main/missing_image.png" %} alt="" />
            {% endif %}
            <p class="date">{{ article.published_at|human_date }}</p>
          </div>
          <div class="body">
            <h3 class="title">{{ article.title }}</h3>
            <p class="source-name">{{ article.source_id }}</p>
            <p class="description">{{ article.description }}</p>
            <p class="content">{{ article.content }}</p> 
          </div>
        </a>
    </article>
  {% endfor %}
</div>
{% endblock %}
